// <auto-generated />
using System;
using System.IO;
using Knapcode.ExplorePackages;

namespace Knapcode.ExplorePackages.Worker.FindPackageAssemblies
{
    /* Kusto DDL:

    .drop table JverPackageAssemblies;

    .create table JverPackageAssemblies (
        ScanId: guid,
        ScanTimestamp: datetime,
        Id: string,
        Version: string,
        CatalogCommitTimestamp: datetime,
        Created: datetime,
        ResultType: string,
        Path: string,
        FileName: string,
        FileExtension: string,
        TopLevelFolder: string,
        CompressedLength: long,
        EntryUncompressedLength: long,
        ActualUncompressedLength: long,
        FileSHA256: string,
        HasException: bool,
        AssemblyName: string,
        AssemblyVersion: string,
        Culture: string,
        AssemblyNameHasCultureNotFoundException: bool,
        AssemblyNameHasFileLoadException: bool,
        PublicKeyToken: string,
        PublicKeyTokenHasSecurityException: bool,
        HashAlgorithm: string,
        HasPublicKey: bool,
        PublicKeyLength: int,
        PublicKeySHA1: string
    );

    .create table JverPackageAssemblies ingestion csv mapping 'JverPackageAssemblies_mapping'
    '['
        '{"Name":"ScanId","Ordinal":0,"DataType":"guid"},'
        '{"Name":"ScanTimestamp","Ordinal":1,"DataType":"datetime"},'
        '{"Name":"Id","Ordinal":2,"DataType":"string"},'
        '{"Name":"Version","Ordinal":3,"DataType":"string"},'
        '{"Name":"CatalogCommitTimestamp","Ordinal":4,"DataType":"datetime"},'
        '{"Name":"Created","Ordinal":5,"DataType":"datetime"},'
        '{"Name":"ResultType","Ordinal":6,"DataType":"string"},'
        '{"Name":"Path","Ordinal":7,"DataType":"string"},'
        '{"Name":"FileName","Ordinal":8,"DataType":"string"},'
        '{"Name":"FileExtension","Ordinal":9,"DataType":"string"},'
        '{"Name":"TopLevelFolder","Ordinal":10,"DataType":"string"},'
        '{"Name":"CompressedLength","Ordinal":11,"DataType":"long"},'
        '{"Name":"EntryUncompressedLength","Ordinal":12,"DataType":"long"},'
        '{"Name":"ActualUncompressedLength","Ordinal":13,"DataType":"long"},'
        '{"Name":"FileSHA256","Ordinal":14,"DataType":"string"},'
        '{"Name":"HasException","Ordinal":15,"DataType":"bool"},'
        '{"Name":"AssemblyName","Ordinal":16,"DataType":"string"},'
        '{"Name":"AssemblyVersion","Ordinal":17,"DataType":"string"},'
        '{"Name":"Culture","Ordinal":18,"DataType":"string"},'
        '{"Name":"AssemblyNameHasCultureNotFoundException","Ordinal":19,"DataType":"bool"},'
        '{"Name":"AssemblyNameHasFileLoadException","Ordinal":20,"DataType":"bool"},'
        '{"Name":"PublicKeyToken","Ordinal":21,"DataType":"string"},'
        '{"Name":"PublicKeyTokenHasSecurityException","Ordinal":22,"DataType":"bool"},'
        '{"Name":"HashAlgorithm","Ordinal":23,"DataType":"string"},'
        '{"Name":"HasPublicKey","Ordinal":24,"DataType":"bool"},'
        '{"Name":"PublicKeyLength","Ordinal":25,"DataType":"int"},'
        '{"Name":"PublicKeySHA1","Ordinal":26,"DataType":"string"}'
    ']'

    */
    partial class PackageAssembly
    {
        public void Write(TextWriter writer)
        {
            writer.Write(ScanId);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(ScanTimestamp));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Id);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Version);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(CatalogCommitTimestamp));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(Created));
            writer.Write(',');
            writer.Write(ResultType);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Path);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, FileName);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, FileExtension);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, TopLevelFolder);
            writer.Write(',');
            writer.Write(CompressedLength);
            writer.Write(',');
            writer.Write(EntryUncompressedLength);
            writer.Write(',');
            writer.Write(ActualUncompressedLength);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, FileSHA256);
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(HasException));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AssemblyName);
            writer.Write(',');
            writer.Write(AssemblyVersion);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Culture);
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(AssemblyNameHasCultureNotFoundException));
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(AssemblyNameHasFileLoadException));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, PublicKeyToken);
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(PublicKeyTokenHasSecurityException));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, HashAlgorithm);
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(HasPublicKey));
            writer.Write(',');
            writer.Write(PublicKeyLength);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, PublicKeySHA1);
            writer.WriteLine();
        }

        public void Read(Func<string> getNextField)
        {
            ScanId = CsvUtility.ParseNullable(getNextField(), Guid.Parse);
            ScanTimestamp = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset);
            Id = getNextField();
            Version = getNextField();
            CatalogCommitTimestamp = CsvUtility.ParseDateTimeOffset(getNextField());
            Created = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset);
            ResultType = Enum.Parse<PackageAssemblyResultType>(getNextField());
            Path = getNextField();
            FileName = getNextField();
            FileExtension = getNextField();
            TopLevelFolder = getNextField();
            CompressedLength = CsvUtility.ParseNullable(getNextField(), long.Parse);
            EntryUncompressedLength = CsvUtility.ParseNullable(getNextField(), long.Parse);
            ActualUncompressedLength = CsvUtility.ParseNullable(getNextField(), long.Parse);
            FileSHA256 = getNextField();
            HasException = bool.Parse(getNextField());
            AssemblyName = getNextField();
            AssemblyVersion = CsvUtility.ParseReference(getNextField(), System.Version.Parse);
            Culture = getNextField();
            AssemblyNameHasCultureNotFoundException = CsvUtility.ParseNullable(getNextField(), bool.Parse);
            AssemblyNameHasFileLoadException = CsvUtility.ParseNullable(getNextField(), bool.Parse);
            PublicKeyToken = getNextField();
            PublicKeyTokenHasSecurityException = CsvUtility.ParseNullable(getNextField(), bool.Parse);
            HashAlgorithm = getNextField();
            HasPublicKey = CsvUtility.ParseNullable(getNextField(), bool.Parse);
            PublicKeyLength = CsvUtility.ParseNullable(getNextField(), int.Parse);
            PublicKeySHA1 = getNextField();
        }
    }
}
