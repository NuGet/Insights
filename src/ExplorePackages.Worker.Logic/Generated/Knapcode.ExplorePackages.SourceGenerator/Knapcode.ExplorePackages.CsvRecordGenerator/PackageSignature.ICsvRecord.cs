// <auto-generated />

using System;
using System.IO;
using System.Threading.Tasks;
using Knapcode.ExplorePackages;

namespace Knapcode.ExplorePackages.Worker.FindPackageSignature
{
    /* Kusto DDL:

    .drop table JverPackageSignatures;

    .create table JverPackageSignatures (
        ScanId: guid,
        ScanTimestamp: datetime,
        Id: string,
        Version: string,
        CatalogCommitTimestamp: datetime,
        Created: datetime,
        ResultType: string,
        HashAlgorithm: string,
        HashValue: string,
        AuthorSHA1: string,
        AuthorSHA256: string,
        AuthorSubject: string,
        AuthorNotBefore: datetime,
        AuthorNotAfter: datetime,
        AuthorTimestampSHA1: string,
        AuthorTimestampSHA256: string,
        AuthorTimestampSubject: string,
        AuthorTimestampNotBefore: datetime,
        AuthorTimestampNotAfter: datetime,
        AuthorTimestampValue: datetime,
        AuthorTimestampHasASN1Error: bool,
        RepositorySHA1: string,
        RepositorySHA256: string,
        RepositorySubject: string,
        RepositoryNotBefore: datetime,
        RepositoryNotAfter: datetime,
        RepositoryTimestampSHA1: string,
        RepositoryTimestampSHA256: string,
        RepositoryTimestampSubject: string,
        RepositoryTimestampNotBefore: datetime,
        RepositoryTimestampNotAfter: datetime,
        RepositoryTimestampValue: datetime,
        RepositoryTimestampHasASN1Error: bool,
        PackageOwners: string
    );

    .create table JverPackageSignatures ingestion csv mapping 'JverPackageSignatures_mapping'
    '['
        '{"Column":"ScanId","DataType":"guid","Properties":{"Ordinal":0}},'
        '{"Column":"ScanTimestamp","DataType":"datetime","Properties":{"Ordinal":1}},'
        '{"Column":"Id","DataType":"string","Properties":{"Ordinal":2}},'
        '{"Column":"Version","DataType":"string","Properties":{"Ordinal":3}},'
        '{"Column":"CatalogCommitTimestamp","DataType":"datetime","Properties":{"Ordinal":4}},'
        '{"Column":"Created","DataType":"datetime","Properties":{"Ordinal":5}},'
        '{"Column":"ResultType","DataType":"string","Properties":{"Ordinal":6}},'
        '{"Column":"HashAlgorithm","DataType":"string","Properties":{"Ordinal":7}},'
        '{"Column":"HashValue","DataType":"string","Properties":{"Ordinal":8}},'
        '{"Column":"AuthorSHA1","DataType":"string","Properties":{"Ordinal":9}},'
        '{"Column":"AuthorSHA256","DataType":"string","Properties":{"Ordinal":10}},'
        '{"Column":"AuthorSubject","DataType":"string","Properties":{"Ordinal":11}},'
        '{"Column":"AuthorNotBefore","DataType":"datetime","Properties":{"Ordinal":12}},'
        '{"Column":"AuthorNotAfter","DataType":"datetime","Properties":{"Ordinal":13}},'
        '{"Column":"AuthorTimestampSHA1","DataType":"string","Properties":{"Ordinal":14}},'
        '{"Column":"AuthorTimestampSHA256","DataType":"string","Properties":{"Ordinal":15}},'
        '{"Column":"AuthorTimestampSubject","DataType":"string","Properties":{"Ordinal":16}},'
        '{"Column":"AuthorTimestampNotBefore","DataType":"datetime","Properties":{"Ordinal":17}},'
        '{"Column":"AuthorTimestampNotAfter","DataType":"datetime","Properties":{"Ordinal":18}},'
        '{"Column":"AuthorTimestampValue","DataType":"datetime","Properties":{"Ordinal":19}},'
        '{"Column":"AuthorTimestampHasASN1Error","DataType":"bool","Properties":{"Ordinal":20}},'
        '{"Column":"RepositorySHA1","DataType":"string","Properties":{"Ordinal":21}},'
        '{"Column":"RepositorySHA256","DataType":"string","Properties":{"Ordinal":22}},'
        '{"Column":"RepositorySubject","DataType":"string","Properties":{"Ordinal":23}},'
        '{"Column":"RepositoryNotBefore","DataType":"datetime","Properties":{"Ordinal":24}},'
        '{"Column":"RepositoryNotAfter","DataType":"datetime","Properties":{"Ordinal":25}},'
        '{"Column":"RepositoryTimestampSHA1","DataType":"string","Properties":{"Ordinal":26}},'
        '{"Column":"RepositoryTimestampSHA256","DataType":"string","Properties":{"Ordinal":27}},'
        '{"Column":"RepositoryTimestampSubject","DataType":"string","Properties":{"Ordinal":28}},'
        '{"Column":"RepositoryTimestampNotBefore","DataType":"datetime","Properties":{"Ordinal":29}},'
        '{"Column":"RepositoryTimestampNotAfter","DataType":"datetime","Properties":{"Ordinal":30}},'
        '{"Column":"RepositoryTimestampValue","DataType":"datetime","Properties":{"Ordinal":31}},'
        '{"Column":"RepositoryTimestampHasASN1Error","DataType":"bool","Properties":{"Ordinal":32}},'
        '{"Column":"PackageOwners","DataType":"string","Properties":{"Ordinal":33}}'
    ']'

    */
    partial record PackageSignature
    {
        public void Write(TextWriter writer)
        {
            writer.Write(ScanId);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(ScanTimestamp));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Id);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, Version);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(CatalogCommitTimestamp));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(Created));
            writer.Write(',');
            writer.Write(ResultType);
            writer.Write(',');
            writer.Write(HashAlgorithm);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, HashValue);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorSHA1);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorSHA256);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorSubject);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(AuthorNotBefore));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(AuthorNotAfter));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorTimestampSHA1);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorTimestampSHA256);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, AuthorTimestampSubject);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(AuthorTimestampNotBefore));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(AuthorTimestampNotAfter));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(AuthorTimestampValue));
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(AuthorTimestampHasASN1Error));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositorySHA1);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositorySHA256);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositorySubject);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(RepositoryNotBefore));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(RepositoryNotAfter));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositoryTimestampSHA1);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositoryTimestampSHA256);
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, RepositoryTimestampSubject);
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(RepositoryTimestampNotBefore));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(RepositoryTimestampNotAfter));
            writer.Write(',');
            writer.Write(CsvUtility.FormatDateTimeOffset(RepositoryTimestampValue));
            writer.Write(',');
            writer.Write(CsvUtility.FormatBool(RepositoryTimestampHasASN1Error));
            writer.Write(',');
            CsvUtility.WriteWithQuotes(writer, PackageOwners);
            writer.WriteLine();
        }

        public async Task WriteAsync(TextWriter writer)
        {
            await writer.WriteAsync(ScanId.ToString());
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(ScanTimestamp));
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, Id);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, Version);
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(CatalogCommitTimestamp));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(Created));
            await writer.WriteAsync(',');
            await writer.WriteAsync(ResultType.ToString());
            await writer.WriteAsync(',');
            await writer.WriteAsync(HashAlgorithm.ToString());
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, HashValue);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorSHA1);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorSHA256);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorSubject);
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(AuthorNotBefore));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(AuthorNotAfter));
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorTimestampSHA1);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorTimestampSHA256);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, AuthorTimestampSubject);
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(AuthorTimestampNotBefore));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(AuthorTimestampNotAfter));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(AuthorTimestampValue));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatBool(AuthorTimestampHasASN1Error));
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositorySHA1);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositorySHA256);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositorySubject);
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(RepositoryNotBefore));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(RepositoryNotAfter));
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositoryTimestampSHA1);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositoryTimestampSHA256);
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, RepositoryTimestampSubject);
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(RepositoryTimestampNotBefore));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(RepositoryTimestampNotAfter));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatDateTimeOffset(RepositoryTimestampValue));
            await writer.WriteAsync(',');
            await writer.WriteAsync(CsvUtility.FormatBool(RepositoryTimestampHasASN1Error));
            await writer.WriteAsync(',');
            await CsvUtility.WriteWithQuotesAsync(writer, PackageOwners);
            await writer.WriteLineAsync();
        }

        public PackageSignature Read(Func<string> getNextField)
        {
            return new PackageSignature
            {
                ScanId = CsvUtility.ParseNullable(getNextField(), Guid.Parse),
                ScanTimestamp = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                Id = getNextField(),
                Version = getNextField(),
                CatalogCommitTimestamp = CsvUtility.ParseDateTimeOffset(getNextField()),
                Created = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                ResultType = Enum.Parse<PackageSignatureResultType>(getNextField()),
                HashAlgorithm = Enum.Parse<NuGet.Common.HashAlgorithmName>(getNextField()),
                HashValue = getNextField(),
                AuthorSHA1 = getNextField(),
                AuthorSHA256 = getNextField(),
                AuthorSubject = getNextField(),
                AuthorNotBefore = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                AuthorNotAfter = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                AuthorTimestampSHA1 = getNextField(),
                AuthorTimestampSHA256 = getNextField(),
                AuthorTimestampSubject = getNextField(),
                AuthorTimestampNotBefore = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                AuthorTimestampNotAfter = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                AuthorTimestampValue = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                AuthorTimestampHasASN1Error = bool.Parse(getNextField()),
                RepositorySHA1 = getNextField(),
                RepositorySHA256 = getNextField(),
                RepositorySubject = getNextField(),
                RepositoryNotBefore = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                RepositoryNotAfter = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                RepositoryTimestampSHA1 = getNextField(),
                RepositoryTimestampSHA256 = getNextField(),
                RepositoryTimestampSubject = getNextField(),
                RepositoryTimestampNotBefore = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                RepositoryTimestampNotAfter = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                RepositoryTimestampValue = CsvUtility.ParseNullable(getNextField(), CsvUtility.ParseDateTimeOffset),
                RepositoryTimestampHasASN1Error = bool.Parse(getNextField()),
                PackageOwners = getNextField(),
            };
        }
    }
}
